<?xml version="1.0" encoding="UTF-8"?>

<!--********************************************************************
Copyright 2019 Dan Margalit and Joseph Rabinoff
Copyright 2020 Ben Williams

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation. A copy of
the license is included in gfdl.xml.
*********************************************************************-->

<section xml:id="DDS" number="6">
 <title>Linear Discrete Dynamical Systems</title>

 <objectives>
 <ol>
 <li>Learn examples of stochastic matrices and applications to difference equations.</li>
 <!-- <li>Understand Google's PageRank algorithm.</li> -->
 <li><em>Recipe:</em> find the steady state of a positive stochastic matrix.</li>
 <li><em>Picture:</em> dynamics of a positive stochastic matrix.</li>
 <li><em>Theorem:</em> the Perron<ndash/>Frobenius theorem.</li>
 <li><em>Vocabulary words:</em> <term>difference equation</term>, <term>(positive) stochastic matrix</term>, <term>steady state</term>, <term>importance matrix</term>, <term>Google matrix</term>.</li>
 </ol>
 </objectives>

 <introduction>
 <p>
 This section is devoted to one common kind of application of eigenvalues: to the study of linear discrete
 dynamical systems. In particular, we will examine Markov chains. We will introduce stochastic matrices, which encode this type of difference equation, and will cover in detail the most famous example of a stochastic matrix: the Google Matrix.
 </p>
 </introduction>

 <subsection>
 <title>Linear Discrete Dynamical Systems</title>

 <p>
 Suppose that we are studying a system whose state at any given time can be described by a list of numbers: for
 instance, the numbers of rabbits aged <m>0,1,</m> and <m>2</m> years, respectively, or the number of customers of
 two different phone companies in Canada. In each case, we can represent the state at time <m>t</m> by a vector
 <m>v_t</m>. We assume that <m>t</m> represents a discrete time quantity: in other words, <m>v_t</m> is the state
 <q>on day <m>t</m></q> or <q>at year <m>t</m></q>. Suppose in addition that the state at time <m>t+1</m> is
 related to the state at time <m>t</m> in a linear way: <m>v_{t+1}=Av_t</m> for some matrix <m>A</m>. This is the
 situation we will consider in this section.
 </p>

 <definition>
 <idx><h>Discrete dynamical system</h></idx>
 <idx><h>Linear Discrete dynamical system</h><see>Discrete dynamical system</see></idx>
 <statement>
 <p>
 A <term>(linear) discrete dynamical system</term> is an equation of the form
 <me>v_{t+1} = Av_t</me>
 for an <m>n\times n</m> matrix <m>A</m> and vectors <m>v_0,v_1,v_2,\ldots</m>.
 </p>
 </statement>
 </definition>

 <p>
 In other words:
 <ul>
 <li><m>v_t</m> is the <q>state at time <m>t</m>,</q></li>
 <li><m>v_{t+1}</m> is the <q>state at time <m>t+1</m>,</q> and</li>
 <li><m>v_{t+1}=Av_t</m> means that <m>A</m> is the <q>change of state matrix.</q></li>
 </ul>
 Note that
 <me>v_t = Av_{t-1} = A^2v_{t-2} = \cdots = A^tv_0,</me>
 which should hint to you that the long-term behavior of such a system is an eigenvalue problem.
 </p>

 <p>
 We will use the following example in this subsection and the next. Understanding this section amounts to understanding this example.
 </p>

 <specialcase xml:id="stochastic-redbox-eg1">
 <idx><h></h></idx>
 <p>
	A truck rental company has locations all over Vancouver, where you can rent moving trucks. You can return
	them to any other location. For simplicity, pretend that there are three locations, and that every customer
	returns their truck the next day. Let <m>v_t</m> be the vector whose entries <m>x_t,y_t,z_t</m> are the number
	of trucks in locations <m>1,2,</m> and <m>3</m>, respectively. Let <m>A</m> be the matrix whose
	<m>i,j</m>-entry is the probability that a customer renting a truck from kiosk <m>j</m> returns it to kiosk <m>i</m>. For example, the matrix
 <me>
 A = \mat{.3 .4 .5; .3 .4 \color{seq-red}.3; \color{seq-green}.4 .2 .2}
 </me>
 encodes a <m>\color{seq-red}30\%</m> probability that a customer renting from location 3 returns the truck to location 2, and a <m>\color{seq-green}40\%</m> probability that a truck rented from location <m>1</m> gets returned to location <m>3</m>. The second row (for instance) of the matrix <m>A</m> says:
 </p>
 <blockquote>
 <p>
 The number of trucks returned to location <m>2</m> will be (on average):
 <me>
 \begin{split}
 30\% \amp\text{ of the trucks from location } 1 \\
 40\% \amp\text{ of the trucks from location } 2 \\
 30\% \amp\text{ of the trucks from location } 3 \\
 \end{split}
 </me>
 </p>
 </blockquote>
 <p>
 Applying this to all three rows, this means
 <me>
 A\vec{x_t y_t z_t} = \vec{.3x_t+.4y_t+.5z_t .3x_t+.4y_t+.3z_t .4x_t+.2y_t+.2z_t}.
 </me>
 Therefore, <m>Av_t</m> represents the number of trucks at each location the next day:
 <me>Av_t = v_{t+1}.</me>
	This is a discrete dynamical system.
 </p>
 </specialcase>

 <p>
 An important question to ask about a dynamical system is: what is its long-term behavior? How many trucks will be
 at each location after 100 days (assuming no intervention from the business owner)? In the next subsection, we will answer this question for a particular type of difference equation.
 </p>

 <example>
 <title>Rabbit population</title>
 <p>
 In a population of rabbits,
 <ol>
 <li>half of the newborn rabbits survive their first year;</li>
 <li>of those, half survive their second year;</li>
 <li>the maximum life span is three years;</li>
 <li>rabbits produce 0, 6, 8 rabbits in their first, second, and third years, respectively.</li>
 </ol>
 Let <m>v_t</m> be the vector whose entries <m>x_t,y_t,z_t</m> are the number of rabbits aged <m>0, 1</m>, and <m>2</m>, respectively. The rules above can be written as a system of equations:
 <me>
 \spalignsysdelims..\syseq{
 x_{t+1} = \. \+ 6y_t + 8z_t;
 y_{t+1} = \frac 12x_t;
 z_{t+1} = \. \+ \frac 12y_t\rlap.
 }
 </me>
 In matrix form, this says:
 <me>\mat{0 6 8; \frac12 0 0; 0 \frac12 0} v_t = v_{t+1}.</me>
 This forms a discrete dynamical system.
 </p>
 <p>
 Define
 <me>A = \mat{0 6 8; \frac12 0 0; 0 \frac12 0}.</me>
 We compute <m>A</m> has eigenvalues <m>2</m> and <m>-1</m>, and that an eigenvector with eigenvalue <m>2</m> is
 <me>v = \vec{16 4 1}.</me>
 This partially explains why the ratio <m>x_t:y_t:z_t</m> approaches <m>16:4:1</m> and why all three quantities eventually double each year in this demo:
 </p>
 <figure>
 <caption>Left: the population of rabbits in a given year. Right: the proportions of rabbits in that year. Choose any values you like for the starting population, and click <q>Advance 1 year</q> several times. Notice that the ratio <m>x_t:y_t:z_t</m> approaches <m>16:4:1</m>, and that all three quantities eventually double each year.</caption>
 <mathbox source="demos/rabbits.html" height="300px"/>
 </figure>
 </example>
 </subsection>

 <subsection>
   <title>Long-term behaviour</title>

   <example hide-type="false">
     <title>A Predator–Prey Model</title>
     <statement>
     <p>
       There is a pond with two species: frogs and midges. The frogs eat the midges. The
       population is counted once a year.
     </p>

     <p>We measure frogs in hundreds (<m>10^2</m>), and midges in hundreds of thousands (<m>10^5</m>).</p>

     <p> If it were not for the frogs, the midge population would increase by <m>30\%</m> each year. We assume
     that each frog kills <m>500</m> midges each year. Equivalently, for each <m>100</m> frogs, the number of midges that gets eaten
     is <m>(0.5) \times 100,000</m>.
     </p>

     <p>
       The growth of the frog population is constrained by the availability of midges. We assume that on average,
       for each <m>100,000</m> midges, <m>0.1 \times 100</m> tadpoles survive to become an adult frog each year.
     </p>

     <p>Finally, we need the death rate of the frog population. It is <m>30\%</m>.  That is, only <m>70\%</m> of the
     adult frogs this year survive until next year.
     </p>

     <p>Set this up as a discrete dynamical system.</p>
     </statement>
     <solution>
       <p>
	 Let <m>f_t</m> denote the number of frogs (in hundreds) after <m>t</m> years have passed, and let <m>m_t</m> denote the number
	 of midges (in hundreds of thousands) after <m>t</m> years have passed. Let
	 <me> v_t = \vec{f_t m_t}.</me>
	 Then the text of the problem tells us that
	 <me> m_{t+1} = 1.3 m_t - 0.5 f_t </me>
	 and
	 <me> f_{t+1} = 0.1 m_t + 0.7 f_t.</me>
	 This can be written in matrix form:
	 <me> v_{t+1} = \mat{1.3  -0.5;  0.1  0.7} v_t. </me>
	 Write
	 <me> A  = \mat{1.3  -0.5; 0.1  0.7} </me>
	 for later reference.
       </p>

       <p>If <m>v_0</m> is the vector containing the population data for this year (midges and frogs), then <m>v_1 =
       Av_2</m> is the vector containing the population data for next year, <m>v_2=Av_1</m> is the vector containing the
       population for the year after, and so on.
       </p>

       <p>For example, if we calculate that there are <m>9\times 10^5</m>midges and <m>700</m> frogs in year 1, then we
       would record this as
       <me> v_0 = \vec{9 7}.</me>
       We could then calculate
       <me>v_1 = \mat{ 1.3  -0.5; 0.1  0.7} \vec{9 7} = \vec{8.2 5.8}</me>
       and
       <me>v_2 = \mat{1.3  -0.5; 0.1  0.7} \vec{8.2 5.8} = \vec{7.76 4.88}.</me>
       This represents <m>776,000</m> midges and <m>488</m> frogs in year <m>3</m>.
       </p>

      <p>
	There are many questions one can ask about the model we have constructed. Let us concentrate here on questions
	about <em>long term</em> behaviour of the model. That is, what happens in our model after a large number of
	years? In mathematical notation, we want to know what <m>v_t</m> looks like as <m>t \to \infty</m>. 
     </p>

     <p>
       In order to study <m>v_t</m>, we start with the observation
       <me> v_t = A v_{t-1} = A A v_{t-2} = \dots = \overbrace{A A \dots A}^{\text{$t$ times}}  v_0. </me>
       This is to say that to get <m>v_t</m>, you apply <m>A</m> to <m>v_0</m> a total of <m>t</m> times.
     </p>

     <p> We previously REFERENCE saw that <m>A^t</m> is troublesome to calculate directly when <m>t</m> is large, but it is
     easier to calculate if we diagonalize: <m>A = CDC^{-1}</m>. In the case of the frogs and midges:
     <me> \mat{1.3  -0.5; 0.1  0.7} = A = CDC^{-1} = \mat{1 5; 1 1}\mat{0.8 0; 0 1.2}\mat{-0.25 1.25; 0.25 -0.25}. </me>
     This allows us to write down a computable formula for <m>v_t</m>:
     <men> v_t = C D^t C^{-1} v_0.</men>
     For instance, if we continue to suppose that <m>v_0=\vec{9 7}</m>, then we calculate
     <men> v_t = \mat{1 5; 1 1}\mat{0.8^t 0; 0 1.2^t}\mat{-0.25 1.25; 0.25 -0.25}\vec{9 7} =  \mat{1 5; 1 1}\mat{0.8^t 0;
     0 1.2^t}\vec{6.5 -0.5}=\mat{1 5; 1 1}\vec{(0.8)^t(6.5) (1.2)^t(-0.5)}=\vec{1(0.8)^t(6.5) 1(0.8)^t(7.5)} +
     \vec{5(1.2)^t(0.5) 1(1.2)^t(0.5)}.</men>
     In even more direct language, the model predicts that the number of frogs (in hundreds) is given by
     <me>f_t = 1(0.8)^t(6.5)+5(1.2)^t(0.5)</me>
     and the number of midges (in hundreds of thousands) is given by
     <me>m_t =  1(0.8)^t(7.5)+1(1.2)^t(0.5).</me>
     </p>

     <p>
       What we asked about the system was the long-term behaviour. From this point of view, the information in REFERENCE
       was more than we needed. We know from calculus that as <m>t</m> grows, the quantity <m>(0.8)^t</m> tends to
       <m>0</m>, whereas <m>(1.2)^t</m> grows without bound. This is good news for our frogs and midges, since it we calculate
       <me> \lim_{t \to \infty} f_t = \lim_{t \to \infty} 1(0.8)^t(6.5)+ \lim_{t\to \infty} 5(1.2)^t(0.5) = 0 + \infty
       </me>
       and similarly for the midges, so the model predicts that both frogs and midges will keep growing in number.
     </p>

     <p>The model can also be used to predict the ratio of frogs to midges. This is a standard kind of limit calculation 
     <me> \lim_{t \to \infty} \frac{f_t}{m_t} = \lim_{t \to \infty} \frac{1(0.8)^t(6.5)+
     5(1.2)^t(0.5)}{1(0.8)^t(7.5)+1(1.2)^t(0.5)} = \frac{5}{1}.</me>
     This says that after several years have passed, the ratio of frogs to midges will be approximately 500 frogs for
     each 100,000 midges, which we can simplify to 1 frog for every 200 midges.
     </p>
   </solution>
 </example>

   <!-- <figure><caption></caption><mathbox -->
   <!--     source="demos/dynamics3.html?mat=0,1:-1,-1&amp;vec=true&amp;size=20&amp;y=1,2,3&amp;flow=false&amp;matname=A&amp;vecname=v" -->
   <!--     height="600px"/> -->
   <!-- </figure> -->
   <!--   <figure><caption></caption><mathbox -->
   <!--     source="demos/dynamics3.html?mat=0.8,0:0,0.8&amp;vec=true&amp;size=20&amp;y=1,2,3&amp;flow=false&amp;matname=A&amp;vecname=v" -->
   <!--     height="600px"/> -->
   <!--  </figure> -->

   <!--  <figure><caption></caption><mathbox -->
   <!--     source="demos/dynamics3.html?mat=1,1:0,1&amp;vec=true&amp;size=20&amp;y=1,2,3&amp;flow=false&amp;matname=A&amp;vecname=v" -->
   <!--     height="600px"/> -->
   <!--  </figure> -->
   <!--  <figure><caption></caption><mathbox -->
   <!--     source="demos/dynamics3.html?mat=0.8,0.3:0.2,0.7&amp;vec=true&amp;size=20&amp;y=1,2,3&amp;flow=false&amp;matname=A&amp;vecname=v" -->
   <!--     height="600px"/> -->
   <!-- </figure> -->

   <!-- <figure><caption></caption><mathbox -->
   <!--     source="demos/dynamics3.html?mat=0.2,0,0:0,0.8,0:0,0,1.2&amp;vec=true&amp;size=20&amp;y=1,2,3&amp;flow=false&amp;matname=A&amp;vecname=v" -->
   <!--     height="600px"/> -->
   <!-- </figure> -->
     
     <warning>
       <p>It is important to keep a consistent ordering of the variables when you work out examples like this. For
       instance, you can list the midges first and the frogs second, to get the matrix
       <me> v_t = \vec{m_t f_t}, \quad  A =  \mat{1.3  -0.5; 0.1 0.7}.</me>
       You can also list the frogs first, and the midges second throughout. In this case, you would get <m>\mat{0.7 
       0.1; -0.5  1.3} </m>, and the vectors you would write down would take the form <m>\vec{f_t m_t}</m>.
       </p>
       <p>Do not mix up the order by writing frogs first sometimes and midges first other times. This will lead
       to nonsense.</p>
     </warning>

     <paragraphs>
       <title>Writing the vectors in terms of eigenvectors</title>
        <p> An analysis such as we did for the system of frogs and midges can be simplified and made more conceptual by
	concentrating on the role of eigenvectors in the story. Concentrating on eigenvectors can also make the process of
	diagonalization less mysterious.
	</p>
	
       <p>
	 Suppose we have a discrete dynamical system
	 <me>v_{t+1} = A v_t</me>
	 and an initial vector <m>v_0</m>, then we can write
	 <me> v_1 = Av_0,\, v_2 = Av_1 = A^2v_0,\, v_3=Av_2 = AA^2v_0 = A^3v_0, \dots \, v_t = A^t v_0.</me>
       </p>

       <p>The situation is simplest when <m>v_0</m> is an eigenvalue of <m>A</m>, with eigenvalue <m>\lambda</m>. In
       this case, the multiplication <m> A v_0 </m> has the effect of stretching <m>v_0</m> by a factor of
       <m>\lambda</m>, so that applying <m>A</m> to <m>v_0</m> repeatedly, say <m>t</m> times, results in scaling
       <m>v_0</m> by <m>\lambda \lambda \cdot \lambda = \lambda^t</m>.
       <me> A^t v_0 = \lambda^t v_0 </me>
       provided <m>v_0</m> is an eigenvector with eigenvalue <m>\lambda</m>.
       </p>

       <p>
	 The next best situation, which is the usual one, is when we can write <m>v_0</m> as a linear combination of
	 eigenvectors of <m>A</m>. Suppose <m>w_1, \dots, w_j</m> are eigenvectors of <m>A</m> with associated
	 eigenvalues <m>\lambda_1, \dots, \lambda_j</m>. If
	 <me> v_0 = c_1 w_1 + \dots + c_j w_j </me>
	 for some coefficients <m>c_1, \dots, c_j</m> then
	 <me> A^t v_0 = c_1 A^t w_1 + \dots + c_j A^t w_j  = c_1\lambda_1^t w_1 + \dots + c_j\lambda_j^t w_j.</me>
	 We can always find ourselves in this situation if <m>A</m> is diagonalizable, because we can find an ordered basis for
	 <m>\R^n</m> made up of eigenvectors of <m>A</m> in this case. We might even be able to write <m>v</m> as a
	 linear combination of eigenvectors even if <m>A</m> is not diagonalizable, but it's not guaranteed.
       </p>

       <p>From now on, we assume <m>A</m> is diagonalizable. Let
       <me> C = \mat[c]{ | |,, | ; w_1 w_2 \dots w_n; | | ,, | }</me>
       be an invertible matrix where the columns are eigenvectors of <m>A</m>. We want to write
       <me> v_0 = c_1w_1 + \dots + c_n w_n, </me>
       which is the same as solving the system of linear equations
       <me> v_0 = C \vec{c_1 c_2 \vdots c_n}</me>
       so that we deduce that
       <me> C^{-1} v_0 = \vec{c_1 c_2 \vdots c_n}. </me>
       This is step 1.
       </p>

       <p>Having written <m>v</m> as a linear combination of eigenvectors, we can calculate <m>v_t</m>:
       <men> v_t = \lambda_1^t c_1 w_1 + \lambda_2^tc_2w_2+\dots + \lambda_n^t c_n w_n.</men>
       In this case we are taking the vectors <m>w_1, w_2, \dots, w_n</m> and are forming the combination with
       coefficients
       <men> \vec{\lambda_1^tc_1 \lambda_2^tc_2 \vdots \lambda_n^tc_n}.</men>
       You can check that if <m>D</m> denotes the diagonal matrix having <m>\lambda_1, \lambda_2, \dots, \lambda_n</m>
       as diagonal entries, then the vector of coefficients is calculated as <m>D^t C^{-1}v_0</m>.
       Then to combine <m>w_1, w_2, \dots, w_n</m> with these coefficients, we take the product <m>C D^t C^{-1}
       </m>. That is to say:
       <me> v_t = C D^t C^{-1} = \lambda_1^t c_1 w_1 + \lambda_2^tc_2w_2+\dots + \lambda_n^t c_n w_n.</me>
       </p>

       <example>
	 <title>Frogs and midges, revisited</title>
	   <p>Revisit the example of frogs and midges explicitly using eigenvectors. Recall that in that case
	   <me> v_{t+1} = A q v_t \quad A = \mat{1.3 -0.5; 0.1 0.7}.</me>
	   Set <m>v_0=\vec{9 7}</m>. We know <m>A</m> has eigenvector–eigenvalue pairs
	   <me> w_1 = \vec{1 1}, \, \lambda_1 = 0.8;\quad w_2=\vec{5 1},\, \lambda_2=1.2.</me>
	   For later use, we set up a little more notation:
	   <me> v_t = \vec{f_t v_t}, \quad C = \mat{1 5; 1 1},\quad D = \mat{0.8 0; 0 1.2}.</me></p>
	   <p>Write <m>v_0</m> in terms of eigenvectors of <m>A</m>:
	   <me>\vec{9 7} = (6.5)\vec{1 1} + (0.5)\vec{5 1}.</me>
	   You can calculate these coefficients in many ways, of course, but one way is to do the multiplication
	   <me> C^{-1} v_0 = \vec{6.5 0.5}. </me></p>

	   <p>We now know that
	   <men xml:id="frogMidge1">v_t  = (0.8)^t(6.5)\vec{1 1} + (1.2)^t (0.5) \vec{5 1},</men>
	   which is saying the same thing as
	   <me> v_t = C D^t C^{-1}v_0</me>
	   in different notation. You can check by expanding out that <xref ref="frogMidge1"/> gives the same
	   information as <xref provisional="previousFrogMidge"/>.
	   </p>

	   <p>Equation <xref ref="frogMidge1"/> is particularly useful for understanding the long-term behaviour of the
	   model. As <m>t</m> grows larger, the coefficient <m>(0.8)^t</m> tends to <m>0</m>. This means that as time
	   goes by, the contribution of <m>(0.8)^t(6.5)\vec{1 1} </m> to <m>v_t</m> becomes less and less important, and
	   the other summand, <m>(1.2)^t (0.5) \vec{5 1}</m> explains the long-term behaviour of the model. For example,
	   we can see directly from Equation <xref ref="frogMidge1"/> that the ratio of <m>f_t</m> (100s of frogs) to
	   <m>m_t</m> (100,000s of midges) tends to <m>5:1</m> as <m>t \to \infty</m>.
	   </p>
	    <figure xml:id="figFrogMidge"><caption>A plot of the number of frogs and midges in each year after year 0. The <m>x</m>-coordinate
     denotes 100s of frogs, and the <m>y</m>-coordinate denotes 100,000s of midges.</caption><mathbox
       source="demos/dynamics3.html?mat=1.3,-0.5:0.1,0.7&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=9,7&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>

     <p>By moving the initial vector around in Figure <xref ref="figFrogMidge"/>, you can see how the long-term behaviour
     of the model depends on <m>v_0</m>. For example, if <m>v_0</m> lies in the eigenspace for <m>0.8</m>, then the
     sequence <m>v_0, Av_0, A^2v_0, \dots</m> is attracted the origin. For any other starting position, the vector
     <m>v_0</m> has some nonzero component in the <m>1.2</m>-eigenspace, and this component will determine the long-term
     behaviour, so that <m>v_0, Av_0, A^2v_0, \dots</m> is eventually repelled by the origin. In a circumstance like
     this, where the origin attracts along some directions and repels along others, the origin is said to be a
     <term>saddle point</term><idx><h>saddle point</h></idx>.</p>
       </example>

       	 <p> There is considerable divirsity in how discrete dynamial systems specified by <m>v_{t+1} = A v_t</m> can
	 behave, even when we restrict our attention to <m>2 \times 2</m> matrices. The following examples do not
	 cover every possibility, but they should be enough to give you the tools to understand every case.
	 </p>

       

	   
	 <example>
	   <p>Suppose <m>A</m> is a diagonalizable <m>2 \times 2</m> matrix with two eigenvalues <m>\lambda_1, \lambda_2</m>, both of
	   which satisfy <m>0 &lt; \lambda &lt;  1</m>. As before, a general <m>v_0</m> can  be written as
	   <me> v_0 = c_1w_1 + c_2 w_2 </me>
	   where <m>w_1, \, w_2</m> are eigenvectors of <m>A</m>. We deduce that
	   <me> v_t = c_1 \lambda_1^t w_1 + c_2 \lambda_2^t w_2 </me>
	   which converges to the origin no matter what initial vector is chosen. We say the origin is an
	   <term>attractor</term><idx><h>attractor</h></idx> in this case.
	   </p>
	   
	   
	   <figure xml:id="figAttractor"><caption></caption><mathbox
	   source="demos/dynamics3.html?mat=0.6,0.2:0.3,0.7&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=9,7&amp;flow=false&amp;matname=A&amp;vecname=v"
	   height="600px"/></figure>
	   <p>In this example, the eigenvalues of <m>A</m> are <m>\lambda_1 = 0.9</m> and <m>\lambda_2 = 0.4</m>. We
	     can write down associated eigenvectors: <m>w_1 = \vec{1 1}</m> and <m>w_2 = \vec{-1 1}</m>. Both
	     <m>\lambda_1</m> and <m>\lambda_2</m> satisfy <m> \lim_{n \to \infty} \lambda^n = 0</m>, and as a
	     consequence, the origin is an attractor. 
	     </p>

	     <p> A subtle point is that even though both eigenvalues are between <m>0</m> and <m>1</m>, nonetheless the
	     larger of the two eigenvalues <m> \lambda_1 = 0.9</m> still influences how the system behaves in the long
	     run more than the smaller eigenvalue <m>\lambda_2 = 0.4</m> does. If we write
	     <me>  v_0 = c_1w_1 + c_2 w_2 = c_1 \vec{1 1} + c_2\vec{-1 1} </me>
	     then
	     <me> v_t = c_1\vec{(0.9)^t1 (0.9)^t1}+c_2\vec{(0.4)^t(-1) (0.4)^t} = \vec{c_1(0.9)^t-c_2(0.4)^t
	     c_1(0.9)^t+(0.4)^t}.</me>
	     The ratio between the first- and second-coordinate entry of <m>v_t</m> is (as a fraction)
	     <me> r_t= \frac{c_1(0.9)^t-c_2(0.4)^t}{c_1(0.9)^t-c_2(0.4)^t}.</me>
	     To see what happens as <m>t \to \infty</m>, we can do a limit calculation
	     <me> \lim_{t \to \infty} r_t = \lim_{t \to \infty}
	     \frac{c_1-c_2\frac{(0.4)^t}{(0.9)^t}}{c_1+c_2\frac{(0.4)^t}{(0.9)^t}} = \frac{ c_1 - 0}{c_1 + 0} = 1</me>
	     provided <m>c_1 \neq 0</m>.</p>
	     <p>This means that as <m>t</m> becomes larger and larger, the vector <m>v_t</m> gets closer and closer to
	     the line spanned by <m>w_1= \vec{1 1}</m>, unless <m>v_0</m> started out in the <m>w_2</m>-eigenspace (in
	     this case, <m>v_t</m> will lie in the <m>w_2</m>-eigenspace for all values of <m>t</m>).</p>
	   </example>

	   <example>
	     <p>The case of two eigenvalues <m> \lambda_1,\, \lambda_2 > 1</m> is similar to that of two eigenvalues <m>
	     0 &lt; \lambda &lt; 1 </m>. The difference is that the sequence <m>v_0, v_1, \dots </m> moves away from,
	     rather than toward, the origin. In this case, the origin is said to be a <term>repeller</term>.</p>
	     <figure><caption></caption><mathbox
       source="demos/dynamics3.html?mat=1.92,-0.36:0.24,1.08&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=-1.1,-4.3&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
	   </example>

     
	   <example>
	     <p>Here is an example where the matrix <m>A</m> has two repeated eigenvalues and is diagonalizable</p>
	     <figure><caption></caption><mathbox
       source="demos/dynamics3.html?mat=1.5,0:0,1.5&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=1,-2&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
	     <p>In this case, the analysis of the model is particularly simple. Every nonzero vector is an eigenvector
	     for this <m>A</m>, since it has a <m>2</m>-dimensional eigenspace. We calculate that <m>v_t= A^tv_0 =
	     (1.5)^t v_0</m> for all <m>t</m>.</p>
	   </example>


	   <example>
	     <p> In section <xref provisional="stochastic"/>, we will devote a lot of attention to matrices where
	     (exactly) one of the eigenvalues is <m>1</m>.</p>

	     <figure><caption></caption><mathbox
	     source="demos/dynamics3.html?mat=1,0.3:0,0.8&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=4,-7&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
	   </example>
	 </paragraphs>

	 <paragraphs>
	   <title>Possibly negative eigenvalues</title>

	   <p>
	       We have said nothing about cases where one or both eigenvalues of <m>A</m> are negative. A negative eigenvalue <m> \lambda_1
	       &lt; 0</m> causes the coefficient of the corresponding eigenvector to switch signs from positive to
	       negative or back again every time <m>A</m> is applied.
	     </p>

	     <p> With the exception that the negative eigenvalue or eigenvalues cause the vectors <m>v_0, v_1, v_2,
	     \dots</m> to &#8220;jump&#8221; back and forth, the analysis of discrete dynamical systems with negative
	     eigenvalues is very similar to that of positive eigenvalues.
	     </p>

	     <p>There are three main cases for a <m>2\times 2</m>-matrix <m>A</m> with two distinct real eigenvalues <m>
	     \lambda_1, \lambda_2</m>
	     <ul>
	         <li>Both of <m> |\lambda_1|, |\lambda_2| </m> are  bigger than <m>0</m> but less than <m>1</m>. In this
		 case, the origin is an attractor, which is to say the sequence <m>v_0, v_1, v_2, \dots </m> will always
		 approach the origin.</li>
	        <li>One of <m> |\lambda_1|, |\lambda_2| </m> is greater than <m>1</m>, and the other is less than <m>1</m>. In this case, the origin is a
	       saddle point, which is to say the sequence <m>v_0, v_1, v_2, \dots </m> can go towards the origin for a
		time, before heading away again (unless it approaches exactly along the eigenspace for the eigenvalue of
		smaller magnitude).</li>
	       <li>Both of <m> |\lambda_1|, |\lambda_2| </m> are greater than <m>1</m>. In this case, the origin is a
	       repeller, which is to say the sequence <m>v_0, v_1, v_2, \dots </m> will always go away from the
	       origin.</li>
	     </ul>
	     </p>

	     <p>Of course, this discussion leaves out a great many special cases. What if <m>|\lambda_1|=1</m>, or
	     <m>\lambda_2 = 0</m>? There are too many of these for it to be helpful for us to cover them all, but by
	     reference to <xref provisional="fundamental formula"/> and a little calculus, you can study them all.
	     </p>

	     <example>
	       <p>Here is a typical example with one positive and one negative eigenvalue. Note that the magnitudes
	       <m>|\lambda_1| &lt; 1</m> and  <m>1 &lt;  |\lambda_2|</m> imply the origin is a saddle point. The sequence <m>v_0, v_1, v_2,
	       \dots </m> goes off to <m>\infty</m> along the <m>\lambda_2</m>-eigenspace. Since <m>\lambda_1</m> is
	       negative, the sequence keeps switching from one side of this eigenspace to the other.</p>
	     
	         <figure><caption><m>-1 &lt; \lambda_1 &lt; 0</m> and <m>1 &lt; \lambda_2</m></caption><mathbox
	     source="demos/dynamics3.html?mat=1,1:1,0&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=-3,2&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
	   </example>
	   
	   <example>
<p> Here is an example where there is a repeated eigenvalue but the matrix is not diagonalizable. Analysis of discrete
dynamical systems is harder than in the diagonalizable case. We will not say much about it here.
</p>
<figure><caption></caption><mathbox
       source="demos/dynamics3.html?mat=1.2,-0.2:0.8,0.4&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=4,-1&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
	   </example>
     </paragraphs>
   </subsection>

   <subsection>
     <title>Discrete dynamical systems with complex eigenvalues</title>
     <p>It can happen that a real matrix <m>A</m> has complex eigenvalues. The associated dynamical systems show
     spiralling behaviour. 
     </p>

     <example>
       <p>Suppose <me>A=\mat{1.1 -0.1; 0.1 1.1}.</me> In this case there are two complex-conjugate eigenvalues:
       <m>\lambda_1=\frac{11}{10} + \frac{i}{10}</m> and <m>\lambda_2=\frac{11}{10} - \frac{i}{10}</m>. They have associated eigenvectors <me>w_1  =
       \vec{ i 1}\quad \text{and} \quad >w_2 = \vec{-i 1}.</me> 
       </p>

       <figure xml:id="figComplexOutward"><caption></caption><mathbox
       source="demos/dynamics3.html?mat=1.1,-0.1:0.1,1.1&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=20&amp;y=-3,3&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>

       <p> Even though the eigenvalues and eigenvectors are not real-valued, we can still carry out our usual
       calculations. For any given <m>v_0</m>, we can decompose it as a linear combination of eigenvectors for
       <m>A</m>. For instance
       <me>v_0 = \vec{-3,3} = \frac{3 + 3i}{2} \vec{i 1}  + \frac{3-3i}{2}\vec{-i 1}.</me>
       This allows us to write
       <me>v_t = \left(\frac{11}{10} + \frac{i}{10}\right)^t \frac{3 + 3i}{2} \vec{i 1}  + \left(\frac{11}{10} -
       \frac{i}{10}\right)^t\frac{3-3i}{2}\vec{-i 1}.</me>
       You can verify that even though this calculation involves imaginary numbers, the vector <m>v_t</m> always has
       real entries.
       </p>
     </example>


     
     <p>Previously, we saw that magnitude of the eigenvalues, i.e., whether <m>|\lambda| &lt; 1</m> or <m>|\lambda| >
       1 </m>, had a big effect on the long-term behaviour of the model. The case of complex eigenvalues is the same,
       with the important modification that we use the <term>complex modulus</term> to measure the magnitude of the
       eigenvalues. If
       <me> z = x + i y \quad \text{ where $x$ and $y$ are in $\R$, then} \quad |z| = \sqrt{x^2 + y^2}. </me>
       The modulus <m>|z|</m>
       has the property that if <m>w, \, z</m> are two complex numbers, then <m>|wz| = |w|\cdot |z|</m>. It
       also has the property that <m> |z| = |\bar z|</m>.     
     </p>
     <p>
       You can see immediately that <m>|z| = 0 </m> if and only if <m>z=0</m>. We say that a sequence of complex numbers
       <m>(z_1, z_2, \dots)</m> <term>tends to infinity</term> if the sequence <m>(|z_1|, |z_2|, \dots  )</m> of
       positive real numbers keeps growing without bound. If <m>z</m> is a complex number, then as <m>t \to \infty</m>
       <me> z^t \text{ tends to } \begin{cases}\text{infinity if $|z| > 1$} \\ \text{$0$ if $|z| &lt; 1$.} \end{cases}</me>
     </p>
     <p>If <m>A</m> is a real <m>2 \times 2</m>-matrix with non-real eigenvalues, <m> \lambda_1, \,
     \lambda_2 =\bar \lambda_1</m>, then there are three possibilities for the long-term behaviour of the associated
     discrete dynamical system.
     <ul>
       <li> If <m> |\lambda_1|=|\lambda_2| &lt; 1 </m>, then the vectors <m> v_0 , v_1, v_2, \dots</m> will spiral
       inwards, towards the origin, which is an attractor.
       </li>
       <li> If <m> |\lambda_1|=|\lambda_2| = 1 </m>, then the vectors <m> v_0 , v_1, v_2, \dots</m> will move around the
       origin in a periodic or quasi-periodic way, neither getting closer or farther away on average.
       </li>
       <li> If <m> |\lambda_1|=|\lambda_2| > 1 </m>, then the vectors <m> v_0 , v_1, v_2, \dots</m> will spiral
       outwards, away from the origin, which is a repeller.
       </li>
     </ul>
     </p>

     <example>
       <p>Here is an example of a discrete dynamical system where the eigenvalues are complex numbers satisfying 
       <m>|\lambda|=1</m>. Observe the rotating behaviour.</p>
        <figure xml:id="figComplexQuasiperiod"><caption></caption><mathbox
	source="demos/dynamics3.html?mat=-3.06123569811873,-4.19535764538226:1.67814305815290,1.97319347633999&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=10&amp;y=-3,3&amp;flow=false&amp;matname=A&amp;vecname=v"
       height="600px"/></figure>
   
     <p>This system is not exactly periodic: there is no <m>t > 0</m> such that <m>v_t = v_0</m>.</p>
     </example>
     <example>
       <title>A periodic discrete dynamical system</title>
       
     <p>It is also possible to have a truly periodic system. In the case illustrated, the matrix <m>A</m> satisfies the
     equation <m>A^7=I_2</m>. This means that the sequence <m>v_0, Av_0 , A^2 v_0 , \dots </m> repeats itself every
     <m>7</m> terms.
     </p>
   <figure xml:id="figComplexPeriod"><caption>A discrete dynamical system of period 7</caption><mathbox
	source="demos/dynamics3.html?mat=-1.72200464554536,-3.90915741234015:1.56366296493606,2.9689842492628&amp;v1=1,0&amp;v2=0,1&amp;vec=true&amp;size=10&amp;y=-3,3&amp;flow=false&amp;matname=A&amp;vecname=v"
	height="600px"/></figure>
     </example>
   </subsection>

   <subsection>
     <title>Discrete dynamical systems in more than 2 dimensions</title>
     <p>
       The basic principles for discrete dynamical systems in more than 2 dimensions remain the same as in 2
       dimensions. As before, we will concentrate on the case where <m>A</m> is diagonalizable.
     </p>

     <p>Even in the <m>3 \times 3</m> case, there are many possibilities for how a discrete dynamical system can
     behave. It would not be helpful to list every possibility here.
     </p>

     <p>In general, if <m>A</m> is an <m>n \times n</m> diagonalizable matrix, then we may find a basis <m> w_1, \dots,
     w_n</m> that consists of eigenvectors of <m>A</m>, with associated eigenvalues <m>\lambda_1, \dots, \lambda_n</m>. Any initial state vector <m>v_0</m> can be written as
     <me> v_0 = c_1 w_1 + c_2 w_2 + \dots + c_n w_n</me>
     and then
     <me> v_t = A^t v_0  = \lambda_1^t c_1 w_1 + \lambda_2^t c_2 w_2 + \dots + \lambda_n^t c_n w_n.</me>
     Questions about the long-term behaviour can then be answered by using limit arguments from calculus.
     </p>

      <note><p>We observe that for a matrix with real-number entries, non-real eigenvalues come in conjugate pairs. It is not
       possible for a real-number <m>3 \times 3</m>-matrix to have three non-real eigenvalues.</p>
      </note>

     <example>
       <p>Consider the matrix <m>A</m> as in the <xref ref="threeDExample"/> below. In this case, the matrix <m>A</m> has three
       eigenvalues
       <me> \lambda_1 = \frac{1+3i}{10}, \quad \lambda_2 = \frac{1-3i}{10}, \quad \lambda_3 = 2.</me>
       with associated eigenvectors
       <me> w_1 = \vec{1 -2 1-i}, \quad w_2 = \vec{1 -2 1+i}, \quad w_3 = \vec{1 0 1},</me>
       where <m>w_1</m> and <m>w_2</m> do not have real-number entries.</p>

       
      
       <figure xml:id="threeDExample"><caption>A representation of a <m>3</m>-dimensional discrete dynamical system</caption>
       <mathbox source="demos/dynamics.html?mat=0.1,0.3:-0.3,0.1&amp;eigenz=2&amp;v1=0,0,1&amp;v2=1,-2,1&amp;v3=-1,0,1&amp;vec=false&amp;path=false" height="600px"/>
       </figure>
       <p>
	 Any vector <m>v_0</m> can be written as a linear combination
	 <me> v_0 = c_1 w_1 + c_2 w_2 + c_3 w_3</me>
	 and so the vector <m>v_t = Av_0</m> can be written as a sum of three vectors:
	 <me> v_t = \left( \frac{1+3i}{10} \right)^t c_1 \vec{1 -2 1-i} + \left(\frac{1-3i}{10}\right)^t c_2 \vec{1 -2
	 1+i} + 2^t c_3 \vec{1 0 1}.</me>
	 As <m>t \to \infty</m>, the first two terms become smaller and smaller, because
	 <me>\left|\frac{1+3i}{10}\right| = \left|\frac{1-3i}{10}\right|= \frac{1}{\sqrt{10}}</me>
	 while the last term takes over (provided <m>c_3 \neq 0</m>). 	 
       </p>
       <p> The long-term behaviour of <m>v_0, v_1, v_2, \dots</m> in this system is to spiral in towards the
       <m>2</m>-eigenspace, the span of <m>\vec{1 0 1}</m>, and to be repelled away from the origin along this
       eigenspace.
       </p>
     </example>
   </subsection>
   </section>
